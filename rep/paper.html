<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2019-06-24 Mon 18:44 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Analyzing the categories of the Kanseki Repository</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="Christian Witterm" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2013 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="ox-content">
<h1 class="title">Analyzing the categories of the Kanseki Repository</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org515e387">1. Overview</a></li>
<li><a href="#orgf9a0e62">2. Method</a>
<ul>
<li><a href="#org461e144">2.1. Sentencepiece</a>
<ul>
<li><a href="#org6dbe7e2">2.1.1. The vocabulary list</a></li>
</ul>
</li>
<li><a href="#org9155316">2.2. N-gram</a></li>
<li><a href="#org07fbb43">2.3. From list to network</a></li>
</ul>
</li>
<li><a href="#org423107d">3. Evaluation</a>
<ul>
<li><a href="#org4e89c91">3.1. Self/other score</a></li>
<li><a href="#org26498ac">3.2. Evaluation based on standard table</a></li>
<li><a href="#org9bf8c90">3.3. Network analysis: Community detection</a></li>
<li><a href="#orgc1ff25a">3.4. Evaluation for ngram</a></li>
</ul>
</li>
<li><a href="#org0fd9fcd">4. Bibliograpy</a></li>
</ul>
</div>
</div>

<div id="outline-container-org515e387" class="outline-2">
<h2 id="org515e387"><span class="section-number-2">1</span> Overview</h2>
<div class="outline-text-2" id="text-1">
<p>
In this paper, an attempt is made to see how the traditional
categories for classifying literature in China compare to an
analysis of the digital text in these categories.  The research is
done using the Kanseki Repository as an example.
</p>
</div>
</div>

<div id="outline-container-orgf9a0e62" class="outline-2">
<h2 id="orgf9a0e62"><span class="section-number-2">2</span> Method</h2>
<div class="outline-text-2" id="text-2">
<p>
Most of the texts in the KR are not punctuated, and none of them are
tokenized. To eliminate the problem of tokenization, for this
research the tool sentencepiece is used. However, to test for the
suitability of the tool, a comparison with ngrams is also performed.
</p>
</div>

<div id="outline-container-org461e144" class="outline-3">
<h3 id="org461e144"><span class="section-number-3">2.1</span> Sentencepiece</h3>
<div class="outline-text-3" id="text-2-1">
<p>
Sentencepiece, developped by researchers at Google, Inc., uses
stochastic methods to find the n most frequent adjoining character
strings in a text.  These adjoining strings, which are not words in
any linguistic sense, are called "sentencepiece".  In a training
run, the tool will analyse the text and build a model of the text,
including a list of the vocabulary (e.g. sentencepieces), which
provides the pieces and the frequency of occurrence in the text
corpus.  This model can than be used to tokenize new texts into
sentencepieces, the usual use case for this is building a pipeline
for natural language processing. In this paper, however, the
vocabulary lists will be used as a proxy for characteristics of the
texts for comparison.
</p>

<p>
Apart from providing the text, the only piece of configuration
needed for building the models, and the only one used here is the
desired number of entries for the vocabulary list.  The number of
unique Kanji in the texts is usually around 11000, so the list
should have more entries.  In preparatory experiments, numbers
ranging from 30000 to 120000 have been used, but it turned out that
such large numbers are not productive, so for the run described
here, only sizes of 30000 and 20000 have been used, to gauge what
influence the vocabulary size might have on the outcome.
</p>
</div>

<div id="outline-container-org6dbe7e2" class="outline-4">
<h4 id="org6dbe7e2"><span class="section-number-4">2.1.1</span> The vocabulary list</h4>
<div class="outline-text-4" id="text-2-1-1">
<p>
The KR is organized in 6 large categories, which each have
subcategories of varying numbers, altogether there are 75
subcategories. Models have been builded separately for all
categories with both vocabulary sizes.  The resulting lists of 75
vocabulary lists in each run have then been consolidated into one
global list of all sentencepieces in the corpus.
</p>

<p>
For each of these entries in the list, we recorded wich
subcategories contained the entry.  Some of the entries occur in all
75 subcategories, while most are only recorded in one.  The number
of co-occurrences across subcategories can be seen as an indicator
of how specific or common a sentencepiece is.  Figure 1 shows 
histograms of distributions<sup><a id="fnr.1" class="footref" href="#fn.1">1</a></sup>.
</p>


<div id="orgdfc513e" class="figure">
<p><img src="./vsize-hist-10000.png" alt="vsize-hist-10000.png" height="300px" />
</p>
<p><span class="figure-number">Figure 1: </span>Number of co-occurrences of vocabulary in bulei, for different sizes of the vocabulary</p>
</div>


<p>
Another item of interest could be the distribution of length of the
vocabulary items for different values of the size. Figure 2 shows
such distributions for different vocabulary sizes.  It seems that the
maximum value for the length is 16.
</p>


<div id="orgf7b20f4" class="figure">
<p><img src="./vlength-hist.png" alt="vlength-hist.png" height="300px" />
</p>
<p><span class="figure-number">Figure 2: </span>Length of sentencepiece items for different vocabulary sizes.</p>
</div>
</div>
</div>
</div>



<div id="outline-container-org9155316" class="outline-3">
<h3 id="org9155316"><span class="section-number-3">2.2</span> N-gram</h3>
<div class="outline-text-3" id="text-2-2">
<p>
Using n-gram as alternative, here with n of 2, 3, 4 and 5. First we
look at the distribution of co-occurrences, as shown in Figure 3.
In this case, the number of ngrams considered has been capped at
the most frequent 30000. Compared to the sentencepiece values in
Figure 1, the curve is much more regular, without the long stretch
of almost identical values between 35 and 70.
</p>


<div id="orgd68e9ca" class="figure">
<p><img src="./ngram-hist-30000.png" alt="ngram-hist-30000.png" height="300px" />
</p>
<p><span class="figure-number">Figure 3: </span>Number of co-occurrences of ngram in bulei, for different values of n.</p>
</div>
</div>
</div>



<div id="outline-container-org07fbb43" class="outline-3">
<h3 id="org07fbb43"><span class="section-number-3">2.3</span> From list to network</h3>
<div class="outline-text-3" id="text-2-3">
<p>
There are many ways to combine the vocabulary lists to form a network.  Here we will consider every subcategory 部類 as a node, co-occurrence of two items in the vocabulary lists of two subcategory as an edge.  The weight of this edge again can be calculated in different ways. Here we consider three possibilities:
</p>
<ul class="org-ul">
<li><b>Count</b>: Co-occurrences are simply counted: For every co-occurrence the
weight counter for the edge between a node-pair is increased.</li>
<li><b>Prob.</b>: Probabilities of the two sentencepieces, as they occur in their
respective subcategory. Here we simply add these probabilities.</li>
<li><b>Pos</b>: Position of the sentencepieces in the vocabulary list.  Since the
vocabulary list is sorted by probability, the position is an
indicator of the probability, but increases much faster than the
probability, thus we increase the scale, although in a non-linear
manner.  Here we assign the highest value to the first position
and then decrease for every piece in the list.  The combined value
for position is the mean of the individual values.</li>
</ul>

<p>
In addition to using various values of weight for the network edges,
we can also limit the edges based on how many subcategories they occur
in.  In the terms of Figure 1 and 2, we can consider an edge only
relevant if it occurs more frequent or less frequent than a
tresholds. We use different upper and lower limits, to see how the
relative frequency of the co-occurrence contributes to forming a
meaningful network.
</p>
</div>
</div>
</div>

<div id="outline-container-org423107d" class="outline-2">
<h2 id="org423107d"><span class="section-number-2">3</span> Evaluation</h2>
<div class="outline-text-2" id="text-3">
</div>
<div id="outline-container-org4e89c91" class="outline-3">
<h3 id="org4e89c91"><span class="section-number-3">3.1</span> Self/other score</h3>
<div class="outline-text-3" id="text-3-1">
<p>
It is difficult to evaluate the results of these calculations.  As
preliminary result, we did 36 calculations for different values of
vocabulary size (10000, 15000, 20000 and 30000), upper and lower limits (70/35,
30/5, 3/1) and combined this with the above mentioned score for the
weight of edges.  Based on the proximity, for every subcategory, we
list the 10 closest subcategories.  As a first approximation (and
since this is relative easy calculated), we consider how many
subcategories from the same category for a given subcategory.  From
this, we produced 18 tables that list the Self/Other score and the 10
top subcategories for each of the values.
For all subcategories 部類 in a category 部, for the 10 most similar
subcategories, a same/other calculation is performed, the maximal
score is thus 10 times the number of the subcategories for a given
category.
</p>

<p>
In addition, to get a better overview, we created <a href="./sp-self-other-results.html">summary tables</a> for
all 6 values 
top categories.  These tables show how they perform in each
calculation and allow for easier comparison.
</p>
</div>
</div>

<div id="outline-container-org26498ac" class="outline-3">
<h3 id="org26498ac"><span class="section-number-3">3.2</span> Evaluation based on standard table</h3>
<div class="outline-text-3" id="text-3-2">
<p>
In order to get a better evaluation of the results, we created a list
with subcategories that should go together and used this to check the
results.  
</p>

<pre class="example">
KR1a 易類	KR3g:術數類
KR2a 正史類	KR2b:編年類,KR2d:別史類,KR2o:史評類
KR2b 編年類	KR2a:正史類,
KR1i 樂類	KR1d:禮類,
KR1e 春秋類	KR2o:史評類
KR2l 職官類	KR2m:政書類,KR2f:詔令奏議類,
KR2m 政書類	KR2l:職官類,KR2f:詔令奏議類,
KR2f 詔令奏議類	KR2l:職官類,KR2m:政書類,
KR3g 術數類	KR3f:天文算法類,
KR3f 天文算法類	KR3g:術數類,
KR4a 楚辭類	KR1c:詩類
KR4c 別集類-唐	KR4d:別集類-宋,
KR4d 別集類-宋	KR4e:別集類-明,KR4c:別集類-唐
KR4e 別集類-明	KR4d:別集類-宋,KR4f:別集類-清
KR4f 別集類-清	KR4e:別集類-明
KR6a 阿含部類	KR6b:本緣部類
KR6l 毘曇部類	KR6n:瑜伽部類
KR6m 中觀部類	KR6n:瑜伽部類
KR6q 禪宗部類	KR6r:史傳部類,KR6p:淨土宗部類
</pre>

<p>
The score is based on the position in the weighted list of
neighbouring subcategories, the first position gets 10 points, from
this one point is deducted as position gets lower, with 10th place
awarded only one point. A list of these scores is also available in
the summary <a href="./sp-self-other-results.html">summary tables</a>.
</p>
</div>
</div>

<div id="outline-container-org9bf8c90" class="outline-3">
<h3 id="org9bf8c90"><span class="section-number-3">3.3</span> Network analysis: Community detection</h3>
<div class="outline-text-3" id="text-3-3">
<p>
There are many ways to detect communities, that is, sub-networks with
a strong mutual relation.  Here we will use the louvain algorithm[1],
which proved to be the best performing algorithm in [2].
</p>

<p>
Communities detected using this algorithm are also linked in the
<a href="./sp-self-other-results.html">summary tables</a>, the number given here is the number of communities for
the network.
</p>
</div>
</div>

<div id="outline-container-orgc1ff25a" class="outline-3">
<h3 id="orgc1ff25a"><span class="section-number-3">3.4</span> Evaluation for ngram</h3>
<div class="outline-text-3" id="text-3-4">
<p>
Using the same method, but with ngrams instead of vocabulary lists
from sentencepiece, we did calculations for ngram networks, the
results are <a href="../nrep/sp-self-other-results.html">summarized here</a>.
</p>
</div>
</div>
</div>


<div id="outline-container-org0fd9fcd" class="outline-2">
<h2 id="org0fd9fcd"><span class="section-number-2">4</span> Bibliograpy</h2>
<div class="outline-text-2" id="text-4">
<p>
[1] Blondel et.al (2008) <a href="https://pdfs.semanticscholar.org/b434/c0199bbf38163abd5f995e76aa1619d39db9.pdf">Fast unfolding of communities in large networks</a>
</p>

<p>
[2] Emmons et. al. (2016) <a href="https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0159161">Analysis of Network Clustering Algorithms and Cluster Quality Metrics at Scale</a>
</p>
</div>
</div>
<div id="footnotes">
<h2 class="footnotes">Footnotes: </h2>
<div id="text-footnotes">

<div class="footdef"><sup><a id="fn.1" class="footnum" href="#fnr.1">1</a></sup> <div class="footpara">In all cases, the values for 1 to 4 have been cut off to avoid distortion of the graph.</div></div>


</div>
</div></div>
<div id="ox-postamble" class="status">
<p class="author">Author: Christian Witterm</p>
<p class="date">Created: 2019-06-24 Mon 18:44</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
